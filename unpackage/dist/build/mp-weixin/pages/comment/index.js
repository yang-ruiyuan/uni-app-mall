(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/comment/index"],{"03a4":function(t,e,n){},"03bb":function(t,e,n){"use strict";var a=n("03a4"),o=n.n(a);o.a},"2a29":function(t,e,n){"use strict";(function(t){n("ad72"),n("921b");a(n("66fd"));var e=a(n("a9c0"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},a9c0:function(t,e,n){"use strict";n.r(e);var a=n("d820"),o=n("b418");for(var r in o)"default"!==r&&function(t){n.d(e,t,function(){return o[t]})}(r);n("03bb");var i=n("2877"),s=Object(i["a"])(o["default"],a["a"],a["b"],!1,null,null,null);e["default"]=s.exports},b418:function(t,e,n){"use strict";n.r(e);var a=n("b4f8"),o=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);e["default"]=o.a},b4f8:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n("2f62"),o=n("6f4a"),r=n("478a");function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){s(t,e,n[e])})}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t){return f(t)||d(t)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function d(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function f(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}var l={name:"comment",data:function(){return{params:{batchcode:"",user_id:"",level:0,discuss:"",pid:[],img:""},tag:1,upLoadIMG:[],loading:!1,list:[],Info:{},baseURL:r.baseURL}},onLoad:function(t){this.params.batchcode=t.batchcode,this.params.user_id=this.userInfo.id,this.tag=+t.tag,2===+t.tag?this.getBagInfo():this.getInfo()},methods:{getInfo:function(){var t=this;(0,o.orderDetail)(this.params).then(function(e){for(var n=e.data[0],a=0;a<n.shop_orders.length;a++)n.shop_orders[a].now_price=(n.shop_orders[a].totalprice/n.shop_orders[a].rcount).toFixed(2);t.Info=n,t.Info.shop_orders.forEach(function(e){t.params.pid.push(e.product_id)}),t.params.pid=JSON.stringify(t.params.pid)})},getBagInfo:function(){var e=this;t.showLoading(),(0,o.BagOrderDetail)(this.params).then(function(n){if(t.hideLoading(),!n.data.code){var a=n.data.data[0],o={};o.CouponPrice=a.totalprice,o.send_express_name=a.expressname,o.address=a.location_p+a.location_c+a.location_a+a.address,o.aftersale_type=0,o.batchcode=a.batchcode,o.createtime=a.createtime,o.confirm_sendtime=a.confirm_sendtime,o.decrease_money=0,o.deductible_money=0,o.expressnum=a.expressnum,o.id=a.p_id,o.is_discuss=0,o.pay_currency=0,o.pay_money=a.package_price,o.paystatus=a.paystatus,o.phone=a.phone,o.pid=a.p_id,o.pname=a.package_name,o.rcount=a.rcount,o.return_status=a.return_status,o.sendMoney=0,o.sendstatus=a.sendstatus,o.shop_orders=[{default_imgurl:a.default_head_imgurl,pname:a.package_name,rcount:a.rcount,now_price:a.package_price}],o.status=0,o.totalprice=a.totalprice,o.user_name="",e.Info=o}})},chooseImg:function(){var e=this;t.chooseImage({sizeType:["original","compressed"],success:function(t){e.list=[].concat(c(e.list),c(t.tempFiles))}})},preview:function(e){t.previewImage({current:this.list[e].path,urls:this.list.map(function(t){return t.path})})},submit:function(){var e=this;if(this.params.level)if(this.params.discuss)if(this.size>10)t.showToast({title:"图片大小超过10M",icon:"none"});else{t.showLoading();var n=function(){return new Promise(function(n,a){e.list.length?e.list.forEach(function(o,r){t.uploadFile({url:"".concat(e.baseURL,"/smallroutine/Reward/upload_eval"),filePath:o.path,name:"img",formData:{customer_id:e.userInfo.customer_id,batchcode:e.Info.batchcode},header:{"Content-Type":"multipart/form-data"},success:function(t){e.upLoadIMG.push(t.data),r===e.upLoadIMG.length-1&&(e.params.img=e.upLoadIMG.toString(),n(!0))},fail:function(){a(!1)}})}):n(!0)})};n().then(function(n){t.hideLoading(),n&&(0,o.Comment)(e.params).then(function(e){t.showModal({title:"",content:"评论成功",success:function(e){e.confirm&&t.navigateBack()}})})})}else t.showToast({title:"请输入评论",icon:"none"});else t.showToast({title:"请选择评分",icon:"none"})}},computed:i({},(0,a.mapState)(["userInfo"]),{size:function(){if(this.list){var t=this.list.reduce(function(t,e){return e.size+t},0);return t/1048576}return 0}})};e.default=l}).call(this,n("543d")["default"])},d820:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.params.level=t.i})},o=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return o})}},[["2a29","common/runtime","common/vendor"]]]);