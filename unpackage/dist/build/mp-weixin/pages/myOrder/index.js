(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myOrder/index"],{"0090":function(t,e,a){"use strict";a.r(e);var n=a("aac6"),o=a("aee5");for(var r in o)"default"!==r&&function(t){a.d(e,t,function(){return o[t]})}(r);a("5016");var s=a("2877"),i=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,null,null);e["default"]=i.exports},5016:function(t,e,a){"use strict";var n=a("e3a9"),o=a.n(n);o.a},7603:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a("6f4a"),o=a("2f62"),r=a("478a");function s(t){return u(t)||c(t)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function u(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}function d(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),n.forEach(function(e){f(t,e,a[e])})}return t}function f(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var h={name:"orders",data:function(){return{baseURL:r.baseURL,currentIndex:0,noData:!1,tabs:[{name:"全部",act:1},{name:"大礼包",act:0},{name:"待付款",act:2},{name:"待发货",act:3},{name:"待收货",act:4},{name:"待评价",act:5},{name:"退款/售后",act:8}],load:!1,list:[],params:{act:1,page:1},same:{}}},onShow:function(){1190===this.userInfo.customer_id&&(this.tabs=this.tabs.filter(function(t){return 0!==t.act})),this.params.user_id=this.userInfo.id||"",this.same.uname=this.userInfo.uname,this.same.ticket=this.userInfo.ticket,this.same.user_id=this.userInfo.id,this.params.page=1,this.list=[],1===this.currentIndex?this.getBagList():this.getList()},computed:d({},(0,o.mapState)(["userInfo"])),methods:{change:function(t,e){this.currentIndex=e,this.list=[],this.params.page=1,0!==t.act?(this.params.act=t.act,this.getList()):this.getBagList()},conOrder:function(e){var a=this;t.showModal({title:"",content:"你确认收货吗？",success:function(o){var r,s;o.confirm&&(t.showLoading(),2===e.tag?(r=n.BagConfirm,s={batchcode:e.batchcode}):(r=n.confirmOrder,s={ticket:a.userInfo.ticket,uname:a.userInfo.uname,user_id:a.userInfo.id,batchcode:e.batchcode}),r(s).then(function(a){t.hideLoading(),4e5!==a.code&&a.data.status?t.showModal({title:"",content:"收货失败",showCancel:!1}):t.showModal({title:"",content:"收货成功",showCancel:!1,complete:function(){e.sendstatus=2}})}))}})},getList:function(){var e=this;this.load=!1,t.showLoading(),(0,n.myOrder)(this.params).then(function(a){if(t.hideLoading(),a.data.length){for(var n=a.data,o=0;o<n.length;o++){var r=parseFloat(n[o].totalprice),i=parseFloat(n[o].sendMoney);n[o].totalprice=(r+i).toFixed(2);for(var c=0,u=0;u<n[o].shop_orders.length;u++)c+=n[o].shop_orders[u].rcount,n[o].shop_orders[u].now_price=(n[o].shop_orders[u].totalprice/n[o].shop_orders[u].rcount).toFixed(2);if(n.rcount=c,0==n[o].status&&0==n[o].paystatus){var d=new Date,f=Date.parse(n[o].shop_orders[0].recovery_time);d.getTime()-f>0&&(n[o].status=-2)}}e.noData=!1,e.load=!0,e.list=[].concat(s(e.list),s(n))}else e.$nextTick(function(){e.noData=!0,1!==e.params.page&&t.showToast({title:"没有更多订单啦>_<",icon:"none"})})})},getBagList:function(){var e=this;t.showLoading(),(0,n.BagOrderList)(this.params).then(function(a){if(t.hideLoading(),a.data.data.length){var n=a.data.data,o=[];n.forEach(function(t){var e={act:1,aftersale_type:0};e.batchcode=t.batchcode,e.couponPrice=0,e.createtime=t.createtime,e.decrease_money=0,e.expressnum=t.expressnum,e.id=0,e.is_discuss=0,e.pay_currency=0,e.pay_money=t.package_price,e.paystatus=t.paystatus,e.pid=t.p_id,e.pname=t.package_name,e.rcount=t.rcount,e.return_status=t.return_status,e.snedMoney=0,e.sendstatus=t.sendstatus,e.shop_orders=[{default_imgurl:t.default_head_imgurl,pname:t.package_name,rcount:t.rcount,now_price:t.package_price}],e.status=0,e.totalprice=t.totalprice,e.tag=2,o.push(e)}),e.noData=!1,e.load=!0,e.list=[].concat(s(e.list),o)}else e.$nextTick(function(){e.noData=!0,1!==e.params.page&&t.showToast({title:"没有更多订单啦>_<",icon:"none"})})})},shopRemind:function(e){t.showLoading();var a=Object.assign({},this.same,{batchcode:e});(0,n.orderRemind)(a).then(function(e){t.hideLoading(),4e5===e.data.code&&t.showModal({title:"",content:e.data.message,showCancel:!1})})},cOrder:function(e){var a=this,o=Object.assign({},this.same,{batchcode:e.batchcode});t.showModal({title:"",content:"确认取消该订单吗?",success:function(r){var s;r.confirm&&(t.showLoading(),s=2===e.tag?n.BagConcel:n.CancelOrder,s(o).then(function(n){t.hideLoading(),a.list=a.list.filter(function(t){return t.batchcode!==e.batchcode}),4e5===n.data.code&&t.showToast({title:n.data.message})}))}})},refresh:function(){},loadMove:function(t){this.load&&(this.params.page++,1===this.currentIndex?this.getBagList():this.getList())}}};e.default=h}).call(this,a("543d")["default"])},a913:function(t,e,a){"use strict";(function(t){a("ad72"),a("921b");n(a("66fd"));var e=n(a("0090"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},aac6:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},o=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return o})},aee5:function(t,e,a){"use strict";a.r(e);var n=a("7603"),o=a.n(n);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);e["default"]=o.a},e3a9:function(t,e,a){}},[["a913","common/runtime","common/vendor"]]]);