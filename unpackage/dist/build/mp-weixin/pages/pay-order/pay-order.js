(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/pay-order/pay-order"],{1390:function(t,a,e){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var s=e("6f4a"),i=e("fffd"),n=e("2f62"),o=e("478a");function r(t){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{},s=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.forEach(function(a){d(t,a,e[a])})}return t}function d(t,a,e){return a in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}var c={data:function(){return{baseURL:o.baseURL,inputPassword:"",passwordInputHidden:!1,batchcode:"",post_data:"",pay_type:"",total_price:"",sendData:{},password:"",c:!0,isDisabled:!1,isPackage:!1}},onLoad:function(t){var a=this;if(console.log(t),t.offsetprice)var e=JSON.parse(t.offsetprice);t.isPackage&&(this.isPackage=t.isPackage);var i=JSON.parse(t.post_data);if(this.batchcode=t.batchcode,this.offsetprice=e,this.post_data=i,this.total_price=t.total_price,1==t.pay_type)var n={pid:i[0].pid};else n={};(0,s.payList)(n).then(function(t){a.pay_type=t.data.data})},onShow:function(){var a=this;(0,s.paySet)({user_id:this.userInfo.id}).then(function(e){e.data.code?a.password=e.data.mge:t.showModal({title:"提示",content:"您还没有设置支付密码",confirmText:"去设置",success:function(a){a.confirm&&t.navigateTo({url:"/pages/setPassword/setPassword"})}})})},methods:{PayWay:function(t){console.log(t),this.isDisabled=!0;var a=t.detail.target.id,e=t.detail.formId,s={appid:this.appid,user_id:this.userInfo.id,formId:e||"",batchcode:this.batchcode,password:this.password,pay_id:a,total_price:this.total_price||this.post_data.totalprice};4==a?(s.openid=this.userInfo.openid,this.sendData=s,this.isPackage?this.createOrder2(s):this.createOrder(s)):(this.sendData=s,this.InputHidden())},InputHidden:function(){this.password?(this.passwordInputHidden=!this.passwordInputHidden,this.inputPassword=""):t.showModal({title:"提示",content:"您还没有设置支付密码",confirmText:"去设置",success:function(a){a.confirm&&t.navigateTo({url:"/pages/setPassword/setPassword"})}})},InputPassword:function(a){var e=this;this.inputPassword=this.inputPassword+a,6==this.inputPassword.length&&this.password==this.inputPassword&&(this.isPackage?(this.createOrder2(),this.InputHidden()):1==this.offsetprice.is_nopassword&&this.offsetprice.numprice>this.offsetprice.nopassword_max?this.c?t.showModal({title:"提示",content:"请输入购物币密码",success:function(t){t.confirm&&(e.inputPassword="",e.c=!1)}}):this.createOrder():(this.createOrder(),this.InputHidden())),6==this.inputPassword.length&&this.password!=this.inputPassword&&t.showModal({title:"",content:"密码错误",success:function(t){t.confirm&&(e.inputPassword="")}})},clear:function(){var t=this.inputPassword.length;t>0&&(this.inputPassword=this.inputPassword.substr(0,t-1))},createOrder:function(){var a=this;t.showLoading({title:"支付中",mask:!0});var e=this.sendData;(0,s.personalPay)(e).then(function(i){if(console.log(JSON.stringify(i)),t.hideLoading(),4e5==i.data.code)if(4==e.pay_id){var n=i.data.msg;if(!i.data.status)return void t.showModal({title:"提示",content:n,showCancel:!1});t.requestPayment({timeStamp:i.data.data.timeStamp,nonceStr:i.data.data.nonceStr,package:i.data.data.package,signType:i.data.data.signType,paySign:i.data.data.paySign,success:function(a){t.redirectTo({url:"/pages/myOrder/index?tab=0"})},fail:function(t){}})}else{t.showToast({title:"支付成功",mask:!0});var o={batchcode:a.batchcode,user_id:a.userInfo.id};(0,s.productVirtual)(o).then(function(t){}),a.grouptype?setTimeout(function(){t.redirectTo({url:"/pages/my-collage_info?batchcode="+a.batchcode})},1500):setTimeout(function(){t.redirectTo({url:"/pages/myOrder/index?tab=0"})},1500)}else t.showModal({title:"提示",content:i.data.msg,showCancel:!1})})},createOrder2:function(){var a=this;t.showLoading({title:"支付中",mask:!0});var e=this.sendData;(0,i.packagePay)(e).then(function(i){if(console.log(JSON.stringify(i)),t.hideLoading(),0==i.data.code)if(4==e.pay_id)t.requestPayment({timeStamp:i.data.data.timeStamp,nonceStr:i.data.data.nonceStr,package:i.data.data.package,signType:i.data.data.signType,paySign:i.data.data.paySign,success:function(a){t.redirectTo({url:"/pages/myOrder/index?tab=0"})},fail:function(t){}});else{t.showToast({title:"支付成功",mask:!0});var n={batchcode:a.batchcode};(0,s.productVirtual)(n).then(function(t){}),setTimeout(function(){t.redirectTo({url:"/pages/myOrder/index?tab=0"})},1500)}else t.showModal({title:"提示",content:i.data.data,showCancel:!1})})}},computed:r({},(0,n.mapState)(["userInfo"]))};a.default=c}).call(this,e("543d")["default"])},"250c":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement;t._self._c},i=[];e.d(a,"a",function(){return s}),e.d(a,"b",function(){return i})},"2b2d":function(t,a,e){"use strict";e.r(a);var s=e("1390"),i=e.n(s);for(var n in s)"default"!==n&&function(t){e.d(a,t,function(){return s[t]})}(n);a["default"]=i.a},"72d3":function(t,a,e){"use strict";e.r(a);var s=e("250c"),i=e("2b2d");for(var n in i)"default"!==n&&function(t){e.d(a,t,function(){return i[t]})}(n);e("a839");var o=e("2877"),r=Object(o["a"])(i["default"],s["a"],s["b"],!1,null,null,null);a["default"]=r.exports},a839:function(t,a,e){"use strict";var s=e("c421"),i=e.n(s);i.a},c421:function(t,a,e){},e268:function(t,a,e){"use strict";(function(t){e("ad72"),e("921b");s(e("66fd"));var a=s(e("72d3"));function s(t){return t&&t.__esModule?t:{default:t}}t(a.default)}).call(this,e("543d")["createPage"])}},[["e268","common/runtime","common/vendor"]]]);