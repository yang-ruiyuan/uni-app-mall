(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product_detail/product_detail"],{"39d3":function(t,e,o){"use strict";o.r(e);var i=o("7f10"),r=o.n(i);for(var a in i)"default"!==a&&function(t){o.d(e,t,function(){return i[t]})}(a);e["default"]=r.a},"483d":function(t,e,o){"use strict";o.r(e);var i=o("7383"),r=o("39d3");for(var a in r)"default"!==a&&function(t){o.d(e,t,function(){return r[t]})}(a);o("de30");var n=o("2877"),u=Object(n["a"])(r["default"],i["a"],i["b"],!1,null,"a2af8c98",null);e["default"]=u.exports},6553:function(t,e,o){},7383:function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement;t._self._c},r=[];o.d(e,"a",function(){return i}),o.d(e,"b",function(){return r})},"7f10":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o("2f62"),r=o("478a"),a=o("6f4a");function n(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{},i=Object.keys(o);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),i.forEach(function(e){u(t,e,o[e])})}return t}function u(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var s={data:function(){return{baseURL:r.baseURL,detail:{nodes1:"",nodes2:"",nodes3:""},flag:!1,address:"",str:"",product:{data:{},product_prices:[],pros_data:[],product_img:[]},currentDetail:1,hidden_property:!1,current_select:[],buy_count:1,current_product:{},isloading:!0,evaluate:"",actionSheetHidden:!1,activity:!1,message:"",activity2:!1,message2:"",coupon:[],ofCoupon:!1,pros_data:"",pros_arry:[],product_id:"",supply_id:"",group:"",groupInfo:"",groupsNum:[],getExplain:"",groupState:!1,group_id:"",remain_score:"",is_privilege:"",robTime:{title:"",countDownDay:"",countDownHour:"",countDownMinute:"",countDownSecond:""},issnapup:"",islimit:"",limitData:{limit_days:"",limit_num:""},pay_type:"",is_virtual:{is_virtual_shop:""},is_integral_product:"",extend_money:0,showtankuang:!1,showhaibao:!1,maskHidden:!0,showTabBar:"",renew_id:"",parent_id:""}},onLoad:function(t){var e=this;this.product_id=t.pid,(0,a.getProductInfo)({user_id:this.userInfo.id,product_id:t.pid}).then(function(t){e.current_product.need_score=t.data.data.need_score,e.current_product.now_price=t.data.data.now_price.toFixed(2),e.current_product.orgin_price=t.data.data.orgin_price.toFixed(2),e.current_product.id=t.data.data.id,e.current_product.storenum=t.data.data.storenum,e.current_product.sell_count=t.data.data.sell_count,e.current_product.show_sell_count=t.data.data.show_sell_count,e.product=t.data,t.data.pros_data.forEach(function(t){e.$set(t,"act",!1),e.$set(t,"list_u","")}),t.data.product_img.forEach(function(t){e.$set(t,"imgurl","/"==t.imgurl.substr(0,1)?r.baseURL+t.imgurl:t.imgurl)}),e.pros_data=t.data.pros_data,e.remain_score=t.data.remain_score,e.isloading=!1,e.detail.nodes1=t.data.data.description.replace(/\<img/gi,'<img style="max-width:100%;height:auto;display:block;"'),e.detail.nodes2=t.data.data.specifications.replace(/\<img/gi,'<img style="max-width:100%;height:auto;display:block;"'),e.detail.nodes3=t.data.data.customer_service.replace(/\<img/gi,'<img style="max-width:100%;height:auto;display:block;"')}),(0,a.getProductOpenLabel)({user_id:this.userInfo.id,pid:t.pid}).then(function(t){if(0==t.data.code){var o=function(t){return t=t.replace(/T/g," ").replace(/\.[\d]{3}Z/,"").replace(/(-)/g,"/"),t=t.slice(0,t.indexOf(".")),new Date(t)};if(1==t.data.data.issnapup){var i=o(t.data.data.buystart_time).getTime().toString().substring(0,10),r=o(t.data.data.countdown_time).getTime().toString().substring(0,10);e.setTimea(i,r),console.log(e.robTime)}1==t.data.data.islimit&&(e.limitData.limit_days=t.data.data.limit_days,e.limitData.limit_num=t.data.data.limit_num),e.is_virtual.is_virtual_shop=t.data.data.is_virtual,e.is_privilege=t.data.data.is_privilege,e.issnapup=t.data.data.issnapup,e.islimit=t.data.data.islimit,e.pay_type=t.data.data.pay_type,e.extend_money=t.data.data.extend_money,e.is_integral_product=t.data.data.is_integral_product,e.parent_id=t.data.data.parent_id,e.is_open_evaluation=t.data.data.is_open_evaluation}}),(0,a.fullpresent)({user_id:this.userInfo.id,product_id:t.pid}).then(function(t){0==t.data.code&&(e.activity=!0),e.message=t.data.message}),(0,a.fullCut)({user_id:this.userInfo.id,product_id:t.pid}).then(function(t){0==t.data.code&&(e.activity2=!0),e.message2=t.data.message}),(0,a.coupon)({user_id:this.userInfo.id,product_id:t.pid}).then(function(t){if(0==t.data.code){e.ofCoupon=!0;var o=[];for(var i in t.data.message){var r,a=t.data.message[i],n=(r={user_scene:a.user_scene,NeedMoney:a.NeedMoney,coupon_id:a.coupon_id,nowtime:a.nowtime,endtime:a.endtime},u(r,"user_scene",a.user_scene),u(r,"MaxMoney",a.MaxMoney),u(r,"remark",a.remark),r);o.push(n)}e.coupon=o}}),(0,a.product_evaluations)({user_id:this.userInfo.id,product_id:t.pid,num:1,pagea:1}).then(function(t){0!=t.data.length&&(e.evaluate=t.data[0]?t.data[0]:"")})},methods:{setTimea:function(t,e){var o=t-Date.parse(new Date)/1e3,i=e-Date.parse(new Date)/1e3;if(o>0)var r="距开抢仅剩:",a=0;if(o<0&&i>0){r="距结束仅剩:";o=i;a=1}var n=setInterval(function(){var t=o,e=Math.floor(t/3600/24),u=e.toString();1==u.length&&(u="0"+u);var s=Math.floor((t-3600*e*24)/3600),d=s.toString();1==d.length&&(d="0"+d);var c=Math.floor((t-3600*e*24-3600*s)/60),p=c.toString();1==p.length&&(p="0"+p);var l=t-3600*e*24-3600*s-60*c,_=l.toString();1==_.length&&(_="0"+_),this.robTime.countDownDay=u,this.robTime.countDownHour=d,this.robTime.countDownMinute=p,this.robTime.countDownSecond=_,this.robTime.title=r,this.robTime.status=a,o--,i<0&&(clearInterval(n),this.robTime.title="抢购活动已结束",this.robTime.countDownDay="00",this.robTime.countDownHour="00",this.robTime.countDownMinute="00",this.robTime.countDownSecond="00",this.robTime.status=0)}.bind(this),1e3)},actionSheetChange:function(){this.actionSheetHidden=!this.actionSheetHidden},onTaptankuang:function(){this.showtankuang=!0},showProductProperty:function(){this.hidden_property=!this.hidden_property,console.log(this.hidden_property)},sub:function(){this.buy_count>1&&(this.buy_count=--this.buy_count)},add:function(){this.buy_count!=this.current_product.storenum?this.buy_count=++this.buy_count:t.showModal({title:"提示",content:"库存不足",showCancel:!1})},inputBuycount:function(t){console.log(t),this.buy_count=t.detail.value},radioChange:function(t,e){var o=this;console.log(t,e),this.pros_data[e].act=!0;var i=this.pros_data;i[e].list_u=t.detail.value,console.log(i);var r=[],n=!0,u=!1,s=void 0;try{for(var d,c=i[Symbol.iterator]();!(n=(d=c.next()).done);n=!0){var p=d.value;r.push(p.list_u)}}catch(g){u=!0,s=g}finally{try{n||null==c.return||c.return()}finally{if(u)throw s}}this.pros_arry=r;var l=r.join("-");console.log(l),this.str=l;for(var _={},h=0;h<this.product.product_prices.length;h++)if(l==this.product.product_prices[h].prope){_.now_price=this.product.product_prices[h].now_price.toFixed(2),_.orgin_price=this.product.product_prices[h].orgin_price.toFixed(2),_.id=this.product.product_prices[h].id,_.storenum=this.product.product_prices[h].storenum,_.need_score=this.current_product.need_score,_.sell_count=this.current_product.sell_count,_.show_sell_count=this.current_product.show_sell_count,this.current_product=_;var f={product_id:this.product_id,prod_id:this.product.product_prices[h].id};(0,a.MemberPrice)(f).then(function(t){0==t.data.code&&(o.current_product.now_price=t.data.data.memberPrice)});break}},showProductDetail:function(t){this.currentDetail=t},collect:function(){this.product.data.collect?this.product.data.collect=0:this.product.data.collect=1,(0,a.check_collect)({user_id:this.userInfo.id,product_id:this.product.data.id,is_collet:this.product.data.collect}).then(function(e){t.showToast({title:e.data.msg})})},addCarts:function(){if(5==this.dianpuleibie&&1==this.pay_type&&t.showModal({title:"提示",content:"该产品是有指定的支付方式,不能加入购物车,只能单独购买",showCancel:!1}),this.buy_count>this.current_product.storenum)t.showModal({title:"提示",content:"库存不足",showCancel:!1});else{this.pros_data.length,this.pros_arry.length;var e="0";console.log(this.pros_data);var o=!0,i=!1,r=void 0;try{for(var a,n=this.pros_data[Symbol.iterator]();!(o=(a=n.next()).done);o=!0){var u=a.value;if(!u.act)return void t.showModal({title:"请选择",content:"请选择"+u.name,showCancel:!1})}}catch(y){i=!0,r=y}finally{try{o||null==n.return||n.return()}finally{if(i)throw r}}this.current_product.need_score&&0==this.pros_data.length&&(e=this.current_product.need_score);var s=this.product,d=this.pros_arry.join("-"),c=this.remain_score;this.buy_count;this.product.product_prices.forEach(function(t,o){t.prope==d&&(t.id,e=t.need_score)});var p={is_virtual_shop:this.is_virtual.is_virtual_shop,pid:s.data.id,pname:s.data.name,prope:d,property_id:"",rcount:this.buy_count,totalprice:this.buy_count*this.current_product.now_price,need_score:e,remain_score:c,default_imgurl:s.data.default_imgurl,remarks:s.data.remarks,now_price:this.current_product.now_price,status:!0,extend_money:this.extend_money},l=this,_=g();""!=_&&(p.property_id=s.product_prices[_].id,p.totalprice=this.buy_count*parseFloat(s.product_prices[_].now_price),p.prope=s.product_prices[_].prope);var h=t.getStorageSync(this.dianpuleibie+"shopping-cart");if(h){for(var f=0;f<h.length;f++)if(p.pid==h[f].pid&&p.property_id==h[f].property_id)return h[f].rcount+=p.rcount,t.setStorageSync(this.dianpuleibie+"shopping-cart",h),void t.showToast({title:"加入购物车成功"});h.push(p),t.setStorageSync(this.dianpuleibie+"shopping-cart",h),t.showToast({title:"加入购物车成功"})}else h=[p],t.setStorageSync(this.dianpuleibie+"shopping-cart",h),t.showToast({title:"加入购物车成功"})}function g(){for(var t="",e=l.str,o=l.product.product_prices,i=0;i<o.length;i++)if(o[i].prope==e)return i;return t}},linktoCart:function(){t.reLaunch({url:"/pages/index/index?current_page=cart"})},gotoEvaluate:function(){t.navigateTo({url:"/pages/evaluate/evaluate?id="+this.product.data.id})},bottomtankuang:function(){this.showtankuang=!0},bottomClose:function(){this.showtankuang=!1},onCoupon:function(e){(0,a.getCoupon)({coupon_id:e}).then(function(e){0==e.code?t.showToast({title:e.message,icon:"success"}):t.showToast({title:e.message,icon:"loading"})})},buy:function(e){var o=this;if(5==this.dianpuleibie){var i=e,r=0,n=0,u=!0,s=!1,d=void 0;try{for(var c,p=this.pros_data[Symbol.iterator]();!(u=(c=p.next()).done);u=!0){var l=c.value;if(!l.act)return void t.showModal({title:"请选择",content:"请选择"+l.name,showCancel:!1})}}catch(T){s=!0,d=T}finally{try{u||null==p.return||p.return()}finally{if(s)throw d}}if(this.current_product.need_score&&0==this.pros_data.length&&(r=this.current_product.need_score*this.buy_count,n=this.current_product.need_score,r>this.remain_score))return void t.showModal({title:"提示",content:"您的会员积分不够",showCancel:!1});if(this.parent_id<0)return void t.showModal({title:"提示",content:"您没有推荐人不能购买",showCancel:!1});if(1!=this.group&&2!=this.group||!i){if(this.buy_count>this.current_product.storenum)return void t.showModal({title:"提示",content:"库存不足",showCancel:!1})}else if(this.buy_count>this.groupInfo.stock)return void t.showModal({title:"提示",content:"库存不足",showCancel:!1});var _=this.product;if(1!=this.group&&2!=this.group||!i)h=this.current_product.now_price;else var h=this.groupInfo.price;var f=this.pros_arry.join("-"),g="",y=this.remain_score,m=this.buy_count;if(this.product.product_prices.forEach(function(t,e){t["prope"]==f&&(g=t.id,r=t.need_score*m,n=t.need_score)}),r>y)return app.showModal("您的会员积分不够！"),void t.showModal({title:"提示",content:"您的会员积分不够",showCancel:!1});var v={pid:_.data.id,pname:_.data.name,property_id:g,rcount:this.buy_count,totalprice:this.buy_count*h,need_score:n,default_imgurl:_.data.default_imgurl,remarks:_.data.remarks,now_price:h,decrease_money:"",supply_id:_.data.supply_id,prope:f,is_virtual_shop:this.is_virtual.is_virtual_shop,extend_money:this.extend_money},w=[v];if(console.log(w),1!=this.group&&2!=this.group||!i)this.$gotoLogin().then(function(e){e&&t.navigateTo({url:"/pages/create-order/create-order?cart="+JSON.stringify(w)+"&couponKeyid=0&couponMoney=0&couponNeedMoney=0&pay_type="+o.pay_type+"&renew_id="+o.renew_id})});else{var b=this.groupInfo.activitie_id,M={pid:i,num:this.buy_count,activitie_id:b,group_id:this.group_id};(0,a.checkCollage)(M).then(function(e){0==e.code?o.data.group_id?t.navigateTo({url:"/pages/create-order/create-order?cart="+JSON.stringify(w)+"&couponKeyid=0&couponMoney=0&couponNeedMoney=0&grouptype="+o.group+"&productid="+i+"&activitie_id="+b+"&group_id="+o.group_id+"&productType="+o.groupInfo.type+"&pay_type="+o.pay_type+"&renew_id="+o.renew_id}):t.navigateTo({url:"/pages/create-order/create-order?cart="+JSON.stringify(w)+"&couponKeyid=0&couponMoney=0&couponNeedMoney=0&grouptype="+o.group+"&productid="+i+"&activitie_id="+b+"&productType="+o.groupInfo.type+"&pay_type="+o.pay_type+"&renew_id="+o.renew_id}):wx.showModal({title:"提示",content:e.message,showCancel:!1})})}}}},computed:n({},(0,i.mapState)(["dianpuleibie","userInfo"]))};e.default=s}).call(this,o("543d")["default"])},c2f2:function(t,e,o){"use strict";(function(t){o("ad72"),o("921b");i(o("66fd"));var e=i(o("483d"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},de30:function(t,e,o){"use strict";var i=o("6553"),r=o.n(i);r.a}},[["c2f2","common/runtime","common/vendor"]]]);